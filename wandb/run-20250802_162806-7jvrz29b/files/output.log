  0%|                                                                                                                                                                                                                                                                        | 0/7 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
C:\Users\razva\OneDrive\Desktop\MasterThesisPostescuRazvanIoan\.venv\Lib\site-packages\torch\utils\checkpoint.py:86: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [33:07<00:00, 283.99s/it]
{'eps': 0, 'objective/kl': 0.17255790531635284, 'objective/entropy': -50.97926712036133, 'objective/non_score_reward': -0.03451158106327057, 'objective/rlhf_reward': 7.496005058288574, 'objective/scores': 7.530516624450684, 'policy/approxkl_avg': 0.0008806745754554868, 'policy/clipfrac_avg': 0.011465292423963547, 'loss/policy_avg': -0.006973923183977604, 'loss/value_avg': 2.355091094970703, 'val/clipfrac_avg': 0.1058327853679657, 'policy/entropy_avg': 0.15155029296875, 'val/ratio': 0.2514773905277252, 'val/ratio_var': 0.19274833798408508, 'val/num_eos_tokens': 30, 'lr': 5e-06, 'episode': 32, 'epoch': 0.0}
{'eps': 0, 'objective/kl': 0.2240564227104187, 'objective/entropy': -52.72339630126953, 'objective/non_score_reward': -0.04481128975749016, 'objective/rlhf_reward': 7.524994850158691, 'objective/scores': 7.569806098937988, 'policy/approxkl_avg': 0.00018945199553854764, 'policy/clipfrac_avg': 0.003373180516064167, 'loss/policy_avg': -0.002912877593189478, 'loss/value_avg': 1.9097356796264648, 'val/clipfrac_avg': 0.02578185312449932, 'policy/entropy_avg': 0.164794921875, 'val/ratio': 0.25007307529449463, 'val/ratio_var': 0.1905878186225891, 'val/num_eos_tokens': 28, 'lr': 4.2857142857142855e-06, 'episode': 64, 'epoch': 0.0}
{'eps': 0, 'objective/kl': 0.09705521166324615, 'objective/entropy': -57.469078063964844, 'objective/non_score_reward': -0.01941104233264923, 'objective/rlhf_reward': 7.6630682945251465, 'objective/scores': 7.682479381561279, 'policy/approxkl_avg': 0.00015061162412166595, 'policy/clipfrac_avg': 0.002464418997988105, 'loss/policy_avg': -0.008749902248382568, 'loss/value_avg': 2.0939903259277344, 'val/clipfrac_avg': 0.050992779433727264, 'policy/entropy_avg': 0.175048828125, 'val/ratio': 0.250100314617157, 'val/ratio_var': 0.190629243850708, 'val/num_eos_tokens': 34, 'lr': 3.5714285714285718e-06, 'episode': 96, 'epoch': 0.01}
{'eps': 0, 'objective/kl': 0.0046215541660785675, 'objective/entropy': -41.375160217285156, 'objective/non_score_reward': -0.0009243106469511986, 'objective/rlhf_reward': 7.497972011566162, 'objective/scores': 7.49889612197876, 'policy/approxkl_avg': 0.00017432402819395065, 'policy/clipfrac_avg': 0.0023627153132110834, 'loss/policy_avg': -0.0017147643957287073, 'loss/value_avg': 1.9144761562347412, 'val/clipfrac_avg': 0.02554800733923912, 'policy/entropy_avg': 0.16094970703125, 'val/ratio': 0.2501744031906128, 'val/ratio_var': 0.19074219465255737, 'val/num_eos_tokens': 30, 'lr': 2.8571428571428573e-06, 'episode': 128, 'epoch': 0.01}
{'eps': 0, 'objective/kl': 0.23976293206214905, 'objective/entropy': -104.41893005371094, 'objective/non_score_reward': -0.04795258492231369, 'objective/rlhf_reward': 7.466648101806641, 'objective/scores': 7.51460075378418, 'policy/approxkl_avg': 9.417304681846872e-05, 'policy/clipfrac_avg': 0.001744528766721487, 'loss/policy_avg': -0.0010101376101374626, 'loss/value_avg': 1.7580068111419678, 'val/clipfrac_avg': 0.009637444280087948, 'policy/entropy_avg': 0.17730712890625, 'val/ratio': 0.25003868341445923, 'val/ratio_var': 0.19053532183170319, 'val/num_eos_tokens': 40, 'lr': 2.1428571428571427e-06, 'episode': 160, 'epoch': 0.01}
{'eps': 0, 'objective/kl': 0.3315892517566681, 'objective/entropy': -61.168418884277344, 'objective/non_score_reward': -0.0663178488612175, 'objective/rlhf_reward': 7.719346046447754, 'objective/scores': 7.785664081573486, 'policy/approxkl_avg': 0.00015620392514392734, 'policy/clipfrac_avg': 0.0018442727159708738, 'loss/policy_avg': -0.002931116847321391, 'loss/value_avg': 1.958543062210083, 'val/clipfrac_avg': 0.0022305313032120466, 'policy/entropy_avg': 0.17742919921875, 'val/ratio': 0.2500053346157074, 'val/ratio_var': 0.19048438966274261, 'val/num_eos_tokens': 51, 'lr': 1.4285714285714286e-06, 'episode': 192, 'epoch': 0.01}
{'eps': 0, 'objective/kl': 0.05374819040298462, 'objective/entropy': -83.8941879272461, 'objective/non_score_reward': -0.010749638080596924, 'objective/rlhf_reward': 7.359103202819824, 'objective/scores': 7.3698530197143555, 'policy/approxkl_avg': 0.00011014306801371276, 'policy/clipfrac_avg': 0.0017717962618917227, 'loss/policy_avg': -0.004060300532728434, 'loss/value_avg': 2.0483896732330322, 'val/clipfrac_avg': 0.0007305177859961987, 'policy/entropy_avg': 0.1890869140625, 'val/ratio': 0.25010520219802856, 'val/ratio_var': 0.19063659012317657, 'val/num_eos_tokens': 36, 'lr': 7.142857142857143e-07, 'episode': 224, 'epoch': 0.02}
PPO-tuned policy saved → ./ppo_secure_qwen
