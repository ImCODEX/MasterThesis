  0%|                                                                                                                                                                                                                                                                      | 0/200 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
C:\Users\razva\OneDrive\Desktop\MasterThesisPostescuRazvanIoan\.venv\Lib\site-packages\torch\utils\checkpoint.py:86: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
 50%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                              | 100/200 [02:42<01:59,  1.19s/it]C:\Users\razva\OneDrive\Desktop\MasterThesisPostescuRazvanIoan\.venv\Lib\site-packages\torch\utils\checkpoint.py:86: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': -0.0037, 'grad_norm': 26.5, 'learning_rate': 4.775e-06, 'num_tokens': 2459.0, 'completions/mean_length': 112.91666666666667, 'completions/min_length': 3.0, 'completions/max_length': 192.0, 'completions/clipped_ratio': 0.5833333333333334, 'completions/mean_terminated_length': 3.0, 'completions/min_terminated_length': 3.0, 'completions/max_terminated_length': 3.0, 'rewards/cvss_reward/mean': -0.4951222439606984, 'rewards/cvss_reward/std': 0.1643418769041697, 'reward': -0.4951222439606984, 'reward_std': 0.113947960237662, 'frac_reward_zero_std': 0.0, 'kl': 0.03434369564056396, 'clip_ratio/low_mean': 0.0953125003608875, 'clip_ratio/low_min': 0.0953125003608875, 'clip_ratio/high_mean': 0.07883184652309864, 'clip_ratio/high_max': 0.07883184652309864, 'clip_ratio/region_mean': 0.17414434688398614, 'epoch': 0.0}
{'loss': -0.0015, 'grad_norm': 0.62109375, 'learning_rate': 4.525000000000001e-06, 'kl': 0.023694562911987304, 'clip_ratio/low_mean': 0.051953125034924594, 'clip_ratio/low_min': 0.051953125034924594, 'clip_ratio/high_mean': 0.0019531250698491933, 'clip_ratio/high_max': 0.0019531250698491933, 'clip_ratio/region_mean': 0.05390625010477379, 'num_tokens': 5744.0, 'completions/mean_length': 168.125, 'completions/min_length': 96.5, 'completions/max_length': 192.0, 'completions/clipped_ratio': 0.875, 'completions/mean_terminated_length': 0.5, 'completions/min_terminated_length': 0.5, 'completions/max_terminated_length': 0.5, 'rewards/cvss_reward/mean': -0.3936775028705597, 'rewards/cvss_reward/std': 0.10707047581672668, 'reward': -0.3936775028705597, 'reward_std': 0.07304602488875389, 'frac_reward_zero_std': 0.25, 'epoch': 0.0}
{'loss': -0.0003, 'grad_norm': 0.5859375, 'learning_rate': 4.2750000000000006e-06, 'num_tokens': 9493.0, 'completions/mean_length': 161.75, 'completions/min_length': 131.33333333333334, 'completions/max_length': 192.0, 'completions/clipped_ratio': 0.8333333333333334, 'completions/mean_terminated_length': 3.5, 'completions/min_terminated_length': 3.3333333333333335, 'completions/max_terminated_length': 3.6666666666666665, 'rewards/cvss_reward/mean': -0.5432458917299906, 'rewards/cvss_reward/std': 0.07941492150227229, 'reward': -0.5432458917299906, 'reward_std': 0.0777275562286377, 'frac_reward_zero_std': 0.0, 'kl': 0.007002735137939453, 'clip_ratio/low_mean': 0.007663352426607162, 'clip_ratio/low_min': 0.007663352426607162, 'clip_ratio/high_mean': 0.005989583290647716, 'clip_ratio/high_max': 0.005989583290647716, 'clip_ratio/region_mean': 0.013652935717254877, 'epoch': 0.0}
{'loss': 0.0003, 'grad_norm': 2.15625, 'learning_rate': 4.0250000000000004e-06, 'kl': 0.010300159454345703, 'clip_ratio/low_mean': 0.00039062501164153216, 'clip_ratio/low_min': 0.00039062501164153216, 'clip_ratio/high_mean': 0.0013020833604969085, 'clip_ratio/high_max': 0.0013020833604969085, 'clip_ratio/region_mean': 0.0016927083721384405, 'num_tokens': 13984.0, 'completions/mean_length': 99.625, 'completions/min_length': 4.5, 'completions/max_length': 192.0, 'completions/clipped_ratio': 0.5, 'completions/mean_terminated_length': 7.5, 'completions/min_terminated_length': 4.5, 'completions/max_terminated_length': 13.5, 'rewards/cvss_reward/mean': -0.40147046744823456, 'rewards/cvss_reward/std': 0.10255252942442894, 'reward': -0.40147046744823456, 'reward_std': 0.010288241086527705, 'frac_reward_zero_std': 0.5, 'epoch': 0.0}
{'loss': 0.0062, 'grad_norm': 17.0, 'learning_rate': 3.7750000000000003e-06, 'num_tokens': 17160.0, 'completions/mean_length': 50.333333333333336, 'completions/min_length': 1.0, 'completions/max_length': 129.0, 'completions/clipped_ratio': 0.16666666666666666, 'completions/mean_terminated_length': 18.5, 'completions/min_terminated_length': 1.0, 'completions/max_terminated_length': 65.33333333333333, 'rewards/cvss_reward/mean': -0.4957994818687439, 'rewards/cvss_reward/std': 0.15288505082329115, 'reward': -0.4957994818687439, 'reward_std': 0.024596508281926315, 'frac_reward_zero_std': 0.3333333333333333, 'kl': 0.1714554786682129, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.08450520833721384, 'clip_ratio/high_max': 0.08450520833721384, 'clip_ratio/region_mean': 0.08450520833721384, 'epoch': 0.0}
{'loss': -0.0, 'grad_norm': 11.75, 'learning_rate': 3.525e-06, 'kl': 0.012753486633300781, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.016536458360496907, 'clip_ratio/high_max': 0.016536458360496907, 'clip_ratio/region_mean': 0.016536458360496907, 'num_tokens': 20007.0, 'completions/mean_length': 120.375, 'completions/min_length': 1.0, 'completions/max_length': 192.0, 'completions/clipped_ratio': 0.625, 'completions/mean_terminated_length': 1.0, 'completions/min_terminated_length': 1.0, 'completions/max_terminated_length': 1.0, 'rewards/cvss_reward/mean': -0.40350620448589325, 'rewards/cvss_reward/std': 0.09742926061153412, 'reward': -0.40350620448589325, 'reward_std': 0.08588940650224686, 'frac_reward_zero_std': 0.25, 'epoch': 0.0}
{'loss': 0.0009, 'grad_norm': 11.5, 'learning_rate': 3.2750000000000004e-06, 'num_tokens': 22025.0, 'completions/mean_length': 49.0, 'completions/min_length': 2.0, 'completions/max_length': 64.66666666666667, 'completions/clipped_ratio': 0.25, 'completions/mean_terminated_length': 2.0, 'completions/min_terminated_length': 2.0, 'completions/max_terminated_length': 2.0, 'rewards/cvss_reward/mean': -0.5652960141499838, 'rewards/cvss_reward/std': 0.07422513638933499, 'reward': -0.5652960141499838, 'reward_std': 0.011689453075329462, 'frac_reward_zero_std': 0.6666666666666666, 'kl': 0.0232696533203125, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.00013020833721384407, 'clip_ratio/high_max': 0.00013020833721384407, 'clip_ratio/region_mean': 0.00013020833721384407, 'epoch': 0.0}
{'loss': 0.0003, 'grad_norm': 1.59375, 'learning_rate': 3.0250000000000003e-06, 'kl': 0.01584653854370117, 'clip_ratio/low_mean': 0.00026041667442768814, 'clip_ratio/low_min': 0.00026041667442768814, 'clip_ratio/high_mean': 0.0005208333488553763, 'clip_ratio/high_max': 0.0005208333488553763, 'clip_ratio/region_mean': 0.0007812500232830643, 'num_tokens': 23953.0, 'completions/mean_length': 96.5, 'completions/min_length': 1.0, 'completions/max_length': 192.0, 'completions/clipped_ratio': 0.5, 'completions/mean_terminated_length': 1.0, 'completions/min_terminated_length': 1.0, 'completions/max_terminated_length': 1.0, 'rewards/cvss_reward/mean': -0.5489445179700851, 'rewards/cvss_reward/std': 0.16554675996303558, 'reward': -0.5489445179700851, 'reward_std': 0.050047473050653934, 'frac_reward_zero_std': 0.5, 'epoch': 0.0}
{'loss': -0.0004, 'grad_norm': 4.1875, 'learning_rate': 2.7750000000000005e-06, 'num_tokens': 27663.0, 'completions/mean_length': 99.0, 'completions/min_length': 1.0, 'completions/max_length': 174.66666666666666, 'completions/clipped_ratio': 0.4166666666666667, 'completions/mean_terminated_length': 19.416666666666668, 'completions/min_terminated_length': 1.0, 'completions/max_terminated_length': 47.333333333333336, 'rewards/cvss_reward/mean': -0.571887751420339, 'rewards/cvss_reward/std': 0.2074149325489998, 'reward': -0.571887751420339, 'reward_std': 0.034463929381066315, 'frac_reward_zero_std': 0.3333333333333333, 'kl': 0.017007827758789062, 'clip_ratio/low_mean': 0.025, 'clip_ratio/low_min': 0.025, 'clip_ratio/high_mean': 0.00026041667442768814, 'clip_ratio/high_max': 0.00026041667442768814, 'clip_ratio/region_mean': 0.025260416674427688, 'epoch': 0.0}
{'loss': 0.0022, 'grad_norm': 40.5, 'learning_rate': 2.5250000000000004e-06, 'kl': 0.05336837768554688, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0004873511963523924, 'clip_ratio/high_max': 0.0004873511963523924, 'clip_ratio/region_mean': 0.0004873511963523924, 'num_tokens': 30779.0, 'completions/mean_length': 96.5, 'completions/min_length': 1.0, 'completions/max_length': 192.0, 'completions/clipped_ratio': 0.5, 'completions/mean_terminated_length': 1.0, 'completions/min_terminated_length': 1.0, 'completions/max_terminated_length': 1.0, 'rewards/cvss_reward/mean': -0.5659517347812653, 'rewards/cvss_reward/std': 0.11623984947800636, 'reward': -0.5659517347812653, 'reward_std': 0.09775965288281441, 'frac_reward_zero_std': 0.5, 'epoch': 0.0}
  warnings.warn(
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [05:48<00:00,  1.74s/it]
{'loss': 0.0005, 'grad_norm': 2.875, 'learning_rate': 2.2750000000000002e-06, 'num_tokens': 33588.0, 'completions/mean_length': 112.41666666666667, 'completions/min_length': 1.0, 'completions/max_length': 192.0, 'completions/clipped_ratio': 0.5833333333333334, 'completions/mean_terminated_length': 1.0, 'completions/min_terminated_length': 1.0, 'completions/max_terminated_length': 1.0, 'rewards/cvss_reward/mean': -0.38944631814956665, 'rewards/cvss_reward/std': 0.16309298823277155, 'reward': -0.38944631814956665, 'reward_std': 0.045614289779526494, 'frac_reward_zero_std': 0.16666666666666666, 'kl': 0.012984657287597656, 'clip_ratio/low_mean': 0.00026041667442768814, 'clip_ratio/low_min': 0.00026041667442768814, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.00026041667442768814, 'epoch': 0.0}
{'loss': -0.0001, 'grad_norm': 0.6875, 'learning_rate': 2.025e-06, 'kl': 0.00972433090209961, 'clip_ratio/low_mean': 0.02526041741948575, 'clip_ratio/low_min': 0.02526041741948575, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.02526041741948575, 'num_tokens': 37359.0, 'completions/mean_length': 74.625, 'completions/min_length': 3.0, 'completions/max_length': 192.0, 'completions/clipped_ratio': 0.375, 'completions/mean_terminated_length': 4.833333373069763, 'completions/min_terminated_length': 3.0, 'completions/max_terminated_length': 7.0, 'rewards/cvss_reward/mean': -0.47646524012088776, 'rewards/cvss_reward/std': 0.09132350236177444, 'reward': -0.47646524012088776, 'reward_std': 0.035446664318442345, 'frac_reward_zero_std': 0.5, 'epoch': 0.0}
{'loss': -0.0003, 'grad_norm': 0.33203125, 'learning_rate': 1.7750000000000002e-06, 'num_tokens': 41768.0, 'completions/mean_length': 120.08333333333333, 'completions/min_length': 20.0, 'completions/max_length': 192.0, 'completions/clipped_ratio': 0.5833333333333334, 'completions/mean_terminated_length': 25.833333333333332, 'completions/min_terminated_length': 20.0, 'completions/max_terminated_length': 31.666666666666668, 'rewards/cvss_reward/mean': -0.32424360513687134, 'rewards/cvss_reward/std': 0.09664866328239441, 'reward': -0.32424360513687134, 'reward_std': 0.03902551004042228, 'frac_reward_zero_std': 0.3333333333333333, 'kl': 0.008597326278686524, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.025, 'clip_ratio/high_max': 0.025, 'clip_ratio/region_mean': 0.025, 'epoch': 0.0}
{'loss': 0.0001, 'grad_norm': 3.703125, 'learning_rate': 1.525e-06, 'kl': 0.0024298667907714845, 'clip_ratio/low_mean': 0.00013020833721384407, 'clip_ratio/low_min': 0.00013020833721384407, 'clip_ratio/high_mean': 0.00013020833721384407, 'clip_ratio/high_max': 0.00013020833721384407, 'clip_ratio/region_mean': 0.00026041667442768814, 'num_tokens': 44691.0, 'completions/mean_length': 72.625, 'completions/min_length': 1.0, 'completions/max_length': 192.0, 'completions/clipped_ratio': 0.375, 'completions/mean_terminated_length': 1.0, 'completions/min_terminated_length': 1.0, 'completions/max_terminated_length': 1.0, 'rewards/cvss_reward/mean': -0.39541269838809967, 'rewards/cvss_reward/std': 0.15261566638946533, 'reward': -0.39541269838809967, 'reward_std': 0.007668605947401375, 'frac_reward_zero_std': 0.5, 'epoch': 0.01}
{'loss': -0.0001, 'grad_norm': 0.25, 'learning_rate': 1.275e-06, 'num_tokens': 48029.0, 'completions/mean_length': 136.5, 'completions/min_length': 33.666666666666664, 'completions/max_length': 192.0, 'completions/clipped_ratio': 0.6666666666666666, 'completions/mean_terminated_length': 33.666666666666664, 'completions/min_terminated_length': 33.666666666666664, 'completions/max_terminated_length': 33.666666666666664, 'rewards/cvss_reward/mean': -0.5309785207112631, 'rewards/cvss_reward/std': 0.10160250961780548, 'reward': -0.5309785207112631, 'reward_std': 0.05792732040087382, 'frac_reward_zero_std': 0.16666666666666666, 'kl': 0.0011333942413330079, 'clip_ratio/low_mean': 0.000520833337213844, 'clip_ratio/low_min': 0.000520833337213844, 'clip_ratio/high_mean': 0.00013020833721384407, 'clip_ratio/high_max': 0.00013020833721384407, 'clip_ratio/region_mean': 0.0006510416744276882, 'epoch': 0.01}
{'loss': 0.0005, 'grad_norm': 1.0546875, 'learning_rate': 1.025e-06, 'kl': 0.01229844093322754, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.00039062501164153216, 'clip_ratio/high_max': 0.00039062501164153216, 'clip_ratio/region_mean': 0.00039062501164153216, 'num_tokens': 50230.0, 'completions/mean_length': 120.375, 'completions/min_length': 1.0, 'completions/max_length': 192.0, 'completions/clipped_ratio': 0.625, 'completions/mean_terminated_length': 1.0, 'completions/min_terminated_length': 1.0, 'completions/max_terminated_length': 1.0, 'rewards/cvss_reward/mean': -0.5703277587890625, 'rewards/cvss_reward/std': 0.15353305637836456, 'reward': -0.5703277587890625, 'reward_std': 0.03983579948544502, 'frac_reward_zero_std': 0.25, 'epoch': 0.01}
{'loss': 0.0005, 'grad_norm': 0.337890625, 'learning_rate': 7.750000000000001e-07, 'num_tokens': 53220.0, 'completions/mean_length': 129.0, 'completions/min_length': 64.66666666666667, 'completions/max_length': 192.0, 'completions/clipped_ratio': 0.6666666666666666, 'completions/mean_terminated_length': 2.0, 'completions/min_terminated_length': 0.6666666666666666, 'completions/max_terminated_length': 3.3333333333333335, 'rewards/cvss_reward/mean': -0.5311503609021505, 'rewards/cvss_reward/std': 0.1510790636142095, 'reward': -0.5311503609021505, 'reward_std': 0.054076746106147766, 'frac_reward_zero_std': 0.0, 'kl': 0.00449981689453125, 'clip_ratio/low_mean': 0.00026041667442768814, 'clip_ratio/low_min': 0.00026041667442768814, 'clip_ratio/high_mean': 0.0007812500116415322, 'clip_ratio/high_max': 0.0007812500116415322, 'clip_ratio/region_mean': 0.0010416666860692202, 'epoch': 0.01}
{'loss': 0.0013, 'grad_norm': 12.6875, 'learning_rate': 5.250000000000001e-07, 'kl': 0.023692226409912108, 'clip_ratio/low_mean': 0.00039062501164153216, 'clip_ratio/low_min': 0.00039062501164153216, 'clip_ratio/high_mean': 0.0014322916627861559, 'clip_ratio/high_max': 0.0014322916627861559, 'clip_ratio/region_mean': 0.0018229166744276881, 'num_tokens': 54656.0, 'completions/mean_length': 75.0, 'completions/min_length': 1.0, 'completions/max_length': 192.0, 'completions/clipped_ratio': 0.375, 'completions/mean_terminated_length': 4.166666746139526, 'completions/min_terminated_length': 1.0, 'completions/max_terminated_length': 10.5, 'rewards/cvss_reward/mean': -0.5282284021377563, 'rewards/cvss_reward/std': 0.11201830208301544, 'reward': -0.5282284021377563, 'reward_std': 0.027316910214722157, 'frac_reward_zero_std': 0.25, 'epoch': 0.01}
{'loss': 0.0005, 'grad_norm': 4.40625, 'learning_rate': 2.75e-07, 'num_tokens': 58853.0, 'completions/mean_length': 112.41666666666667, 'completions/min_length': 1.0, 'completions/max_length': 192.0, 'completions/clipped_ratio': 0.5833333333333334, 'completions/mean_terminated_length': 1.0, 'completions/min_terminated_length': 1.0, 'completions/max_terminated_length': 1.0, 'rewards/cvss_reward/mean': -0.5714668730894724, 'rewards/cvss_reward/std': 0.13207606102029482, 'reward': -0.5714668730894724, 'reward_std': 0.05085823514188329, 'frac_reward_zero_std': 0.16666666666666666, 'kl': 0.010030555725097656, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.00026041667442768814, 'clip_ratio/high_max': 0.00026041667442768814, 'clip_ratio/region_mean': 0.00026041667442768814, 'epoch': 0.01}
{'loss': 0.0, 'grad_norm': 0.58203125, 'learning_rate': 2.5000000000000002e-08, 'kl': 0.003929853439331055, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.00013020833721384407, 'clip_ratio/high_max': 0.00013020833721384407, 'clip_ratio/region_mean': 0.00013020833721384407, 'num_tokens': 60306.0, 'completions/mean_length': 95.375, 'completions/min_length': 1.0, 'completions/max_length': 192.0, 'completions/clipped_ratio': 0.375, 'completions/mean_terminated_length': 31.5, 'completions/min_terminated_length': 1.0, 'completions/max_terminated_length': 92.0, 'rewards/cvss_reward/mean': -0.5948857367038727, 'rewards/cvss_reward/std': 0.1534545198082924, 'reward': -0.5948857367038727, 'reward_std': 0.047198474407196045, 'frac_reward_zero_std': 0.25, 'epoch': 0.01}
{'train_runtime': 350.0336, 'train_samples_per_second': 2.285, 'train_steps_per_second': 0.571, 'train_loss': 0.0003440996920107864, 'epoch': 0.01}
[Stage 2] Fine-tuned policy saved → ./grpo_secure_qwen
